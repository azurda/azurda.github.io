<!DOCTYPE html>
<html lang="en-us">
<head>
	<meta name="generator" content="Hugo 0.82.0" />
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<style type=text/css>body{font-family:monospace;}</style>
	<title>azurda&#39;s blog</title>
	
	
	<link rel="stylesheet" href="/css/style.css">
	
	<link rel="alternate" type="application/rss+xml" href="/index.xml" title="azurda's blog">
</head>
<body>
	<header>
	===================<br>
	== <a href="https://azurda.github.io">azurda&#39;s blog</a> ==<br>
	===================
	<div style="float: right;">Blog about reverse engineering, game hacking and frida.</div><br>
	<p>
	<nav>
			<a href="/"><b>Start</b></a>.
			
			
			<a href="/posts/"><b>Posts</b></a>.
			
			<a href="/categories/"><b>Categories</b></a>.
			
			<a href="/tags/"><b>Tags</b></a>.
			
	</nav>
	</p>
	
</header>

	
	<main>
		
		
			<article>
	<h1><a href="https://azurda.github.io/posts/reading-std-string-c&#43;&#43;/">Reading std::string C&#43;&#43;</a></h1>
	<b><time>52.21.16164 14:52</time></b>
	
	<div>
		Something that is very interesting to us is the ability to read strings, however this is not always possible by simply calling FRIDA&rsquo;s readUtf8String/readCString built-ins due to the different ways a string can be represented. For example, Window&rsquo;s UNICODE_STRING is defined in a struct as follows:
typedef struct _UNICODE_STRING { USHORT Length; USHORT MaximumLength; PWSTR Buffer; } UNICODE_STRING, *PUNICODE_STRING; A common string type to parse is a C++ std::string. A similar concept will be seen in Swift.
		
			<a href="https://azurda.github.io/posts/reading-std-string-c&#43;&#43;/">Read more...</a>
		
	</div>
</article>

		
			<article>
	<h1><a href="https://azurda.github.io/posts/proxy-quake-vm-syscalls-frida/">Proxy Quake Vm Syscalls Frida</a></h1>
	<b><time>49.21.16164 14:49</time></b>
	
	<div>
		Tools used: radare2 for disassembly, Frida for instrumentation.
Note: This is post is written from my understanding of the q3vm and is not meant to be a throughout explanation of it. If you want a more detailed, accurate description of is internals I encourage you to read about it in Fabien&rsquo;s blog, which helped me fill some gaps.
What we are going to see in this post:
 A very basic understanding of how the Q3VM loads the game How to make small instrumentation script with Frida to detect new players connecting and userinfo changes without doing any engine modifications or loading server-side mods.
		
			<a href="https://azurda.github.io/posts/proxy-quake-vm-syscalls-frida/">Read more...</a>
		
	</div>
</article>

		
			<article>
	<h1><a href="https://azurda.github.io/posts/objective-c-hooking/">Objective C Hooking with FRIDA</a></h1>
	<b><time>50.21.16161 14:50</time></b>
	
	<div>
		We will read a method that has two arguments. For this purpose, we will write a sample program to call [fileManager fileExistsAtPath: isDirectory:].
  We will also use FRIDA&rsquo;s REPL to get the method pointer differently.
  Sample code:
int main(int argc, const char * argv[]) { @autoreleasepool { NSString *filepath = @&#34;/Users/azurda/Desktop/test.c&#34;; NSFileManager *fileManager = [NSFileManager defaultManager]; BOOL res; if ([fileManager fileExistsAtPath:filepath isDirectory:&amp;res]) { NSLog(@&#34;File exists.
		
			<a href="https://azurda.github.io/posts/objective-c-hooking/">Read more...</a>
		
	</div>
</article>

		
			<article>
	<h1><a href="https://azurda.github.io/posts/searchpathw-hook-frida/">Searchpathw Hook Frida</a></h1>
	<b><time>49.20.16165 14:49</time></b>
	
	<div>
		Note: *This is a quick blog post to answer the issue of an user from the FRIDA IRC / telegram channel. *
In this case what we want to do is to hook the SearchPathW WINAPI:
DWORD SearchPathW( LPCWSTR lpPath, LPCWSTR lpFileName, LPCWSTR lpExtension, DWORD nBufferLength, LPWSTR lpBuffer, LPWSTR *lpFilePart ); In this case, we want to obtain the most meaningful argument which is in this case the second one, lpFileName.
		
			<a href="https://azurda.github.io/posts/searchpathw-hook-frida/">Read more...</a>
		
	</div>
</article>

		
			<article>
	<h1><a href="https://azurda.github.io/posts/reading-structs-frida/">Reading Structs Frida</a></h1>
	<b><time>48.20.16164 14:48</time></b>
	
	<div>
		We are able to read function arguments with FRIDA using the args:NativePointer[] array. However, this is not possible with arguments that are not simple types such as structs.
Where can we find structs? We can find structs in the Unix time libraries for example, or more importantly in Windows&rsquo;s APICALLs such as the ones in NTDLL.
Stages:
 Understanding and reading a user-controlled struct. Reading a UNIX syscall structure. Reading a Windows NTDLL structure.
		
			<a href="https://azurda.github.io/posts/reading-structs-frida/">Read more...</a>
		
	</div>
</article>

		
		<div>

1 of 1

</div>

	</main>

	<footer>
	<p>&copy; 2021 <a href="https://azurda.github.io"><b>azurda&#39;s blog</b></a>.
	<a href="https://github.com/azurda"><b>Github</b></a>.
	<a href="https://twitter.com/@entdark_"><b>Twitter</b></a>.
	<a href="https://web.libera.chat"><b>Join #azurda-re in libera.chat</b></a>.
	</p>
</footer>

</body>
</html>
