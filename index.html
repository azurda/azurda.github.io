<!DOCTYPE html>
<html lang="en-us">
<head>
	<meta name="generator" content="Hugo 0.74.3" />
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<style type=text/css>body{font-family:monospace;}</style>
	<title>azurda</title>
	
	
	<link rel="stylesheet" href="/css/style.css">
	
	<link rel="alternate" type="application/rss+xml" href="/index.xml" title="azurda">
</head>
<body>
	<header>
	============<br>
	== <a href="https://azurda.github.io/">azurda</a> ==<br>
	============
	<div style="float: right;">Blog about reverse engineering, game hacking and frida.</div><br>
	<p>
	<nav>
			<a href="/"><b>Start</b></a>.
			
			
			<a href="/categories/"><b>Categories</b></a>.
			
			<a href="/tags/"><b>Tags</b></a>.
			
	</nav>
	</p>
	
</header>

	
	<main>
		
		
			<article>
	<h1><a href="https://azurda.github.io/posts/q3vm-hook/">Proxy QUAKE3 VM calls with Frida</a></h1>
	<b><time>2021-01-23 12:12:12</time></b>
	
	<div>
		Tools used: radare2 for disassembly, Frida for instrumentation.
Note: This is post is written from my understanding of the q3vm and is not meant to be a throughout explanation of it. If you want a more detailed, accurate description of is internals I encourage you to read about it in Fabien&rsquo;s blog, which helped me fill some gaps.
What we are going to see in this post:
 A very basic understanding of how the Q3VM loads the game How to make small instrumentation script with Frida to detect new players connecting and userinfo changes without doing any engine modifications or loading server-side mods.
		
			<a href="https://azurda.github.io/posts/q3vm-hook/">Read more...</a>
		
	</div>
</article>

		
			<article>
	<h1><a href="https://azurda.github.io/posts/searchpathw/">SearchPathW hook &#43; example code.</a></h1>
	<b><time>2021-01-22 10:18:48</time></b>
	
	<div>
		Note: This is a quick blog post to answer the issue of an user from the FRIDA IRC / telegram channel.
In this case what we want to do is to hook the SearchPathW WINAPI:
DWORD SearchPathW( LPCWSTR lpPath, LPCWSTR lpFileName, LPCWSTR lpExtension, DWORD nBufferLength, LPWSTR lpBuffer, LPWSTR *lpFilePart ); In this case, we want to obtain the most meaningul argument which is in this case the second one, lpFileName. It is possible to extract information from the remaining fields if wanted.
		
			<a href="https://azurda.github.io/posts/searchpathw/">Read more...</a>
		
	</div>
</article>

		
			<article>
	<h1><a href="https://azurda.github.io/posts/frida-tools/">Frida Tools</a></h1>
	<b><time>2020-12-22 23:10:36</time></b>
	
	<div>
		The frida-tools package offers some CLI tools that we can use for quick binary instrumentation. We can install them by simply running the following command:
pip install frida-tools
We are going to take a look at the most important tools: frida CLI and frida-trace
frida-trace This tool alllows us to instrument processes or apps without the need of writing an instrumentation tool. This tool&rsquo;s funtionality is based on the Interceptor API:
		
			<a href="https://azurda.github.io/posts/frida-tools/">Read more...</a>
		
	</div>
</article>

		
			<article>
	<h1><a href="https://azurda.github.io/posts/structs/">Reading structs with Frida</a></h1>
	<b><time>2020-12-15 02:18:48</time></b>
	
	<div>
		We are able to read function arguments with FRIDA using the args:NativePointer[] array. However, this is not possible with arguments that are not simple types such as structs.
Where can we find structs? We can find structs in the Unix time libraries for example, or more importantly in Windows&rsquo;s APICALLs such as the ones in NTDLL.
Stages:
 Understanding and reading a user-controlled struct. Reading a UNIX syscall structure. Reading a Windows NTDLL structure.
		
			<a href="https://azurda.github.io/posts/structs/">Read more...</a>
		
	</div>
</article>

		
		<div>

1 of 1

</div>

	</main>

	<footer>
	<p>&copy; 2021 <a href="https://azurda.github.io/"><b>azurda</b></a>.
	<a href="https://github.com/azurda"><b>Github</b></a>.
	<a href="https://twitter.com/entdark_"><b>Twitter</b></a>.
	<a href="#ZgotmplZ"><b>frida IRC</b></a>.
	</p>
</footer>

</body>
</html>
