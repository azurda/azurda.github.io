<!DOCTYPE html>
<html lang="en"><head>
    <title>AZURDA.386</title>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
    <meta content="utf-8" http-equiv="encoding">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="format-detection" content="telephone=no" />
    <meta name="theme-color" content="#000084" />
    <link rel="icon" href="https://azurda.github.io/favicon.ico">
    <link rel="canonical" href="https://azurda.github.io">
    
    
</head>
<body>
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container">
            <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse"></button>
            <a class="brand" href="https://azurda.github.io">AZURDA.386</a>
            <div class="nav-collapse collapse">
                <ul class="nav">
                    
                    
                        
                            <li>
                                <a href="/about/">
                                    
                                    <span>About</span>
                                </a>
                            </li>
                        
                    
                        
                            <li>
                                <a href="/post/">
                                    
                                    <span>All posts</span>
                                </a>
                            </li>
                        
                    
                </ul>
            </div>
        </div>
    </div>
</nav><div id="content" class="container">

<div class="row-fluid navmargin">
    <div class="page-header">
        <h1>Proxy Quake Vm Syscalls Frida - Fri, Apr 16, 2021</h1>
    </div>
    <p class="lead"></p>
    <p>Tools used: <code>radare2</code> for disassembly, <code>Frida</code> for instrumentation.</p>
<p><strong>Note</strong>: This is post is written from my understanding of the q3vm and is not meant to be a throughout explanation of it.
If you want a more detailed, accurate description of is internals I encourage you to read about it in <a href="https://fabiensanglard.net/quake3/qvm.php">Fabien&rsquo;s blog</a>, which helped me fill some gaps.</p>
<p>What we are going to see in this post:</p>
<ul>
<li>A very basic understanding of how the <code>Q3VM</code> loads the game</li>
<li>How to make small instrumentation script with Frida to detect new players connecting and userinfo changes without doing any engine modifications or loading server-side mods.</li>
</ul>
<p>In essence, when the engine starts:</p>
<ol>
<li>Search for PK3s (PK3 are the packed files that quake-based games parse) that are in the desired <code>fs_game</code> folder + the base game&rsquo;s folder. E.g: If we use the JA&rsquo;s JA+(japlus) mod, the engine will search for PK3 files in <code>base/</code> and <code>japlus/</code> folders.</li>
<li>Initialize dynamic memory (<code>com_hunkMegs</code>, <code>com_zoneMegs</code>) and open sockets.</li>
</ol>
<p>And it stops there (there are more things happening but it is not the point of this post) until a valid map is provided, which starts the game. An example of a JA valid map command would be: map mp/duel1:</p>
<ol>
<li>Loads the <code>BSP</code> file matching the levelname provided.</li>
<li>If it is not a base BSP, it tries to find it in any of the loaded PK3s</li>
<li>Loads the QVM</li>
<li>Jumps to <code>vmMain()</code></li>
<li>Does whatever syscall has received</li>
<li>Jumps to <code>vmMain()</code> again and again and again.</li>
</ol>
<p>Some of these vmMain arguments that can be received:</p>
<ul>
<li>GAME_INIT: Game startup</li>
<li>GAME_SHUTDOWN: Map change or server shutdown.</li>
<li>GAME_CLIENT_CONNECT: Client, bot or real connects.</li>
<li>GAME_CLIENT_USERINFO_CHANGED: Client info changes, forcestrings, playermodels, name&hellip;</li>
</ul>
<p>&hellip; and more</p>
<p>If you want a more detailed list refer to <code>gameExport_t</code> struct in <code>game/g_public.h</code> <a href="https://github.com/jedis/jediacademy/blob/master/codemp/game/g_public.h#L734-L799">https://github.com/jedis/jediacademy/blob/master/codemp/game/g_public.h#L734-L799</a></p>
<p>Alright, that is enough Q3VM for now&hellip;</p>
<p>Firsts things first, we want to where the vmMain export is in the original binary (we are using the 2003 bins ;) ), so we will chage for <code>jampgamex86.dll</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-nasm" data-lang="nasm"><span style="color:#960050;background-color:#1e0010">[0</span><span style="color:#a6e22e">x200ddd31</span>]<span style="color:#f92672">&gt;</span> iE
<span style="color:#960050;background-color:#1e0010">[</span><span style="color:#66d9ef">Export</span>s]

<span style="color:#a6e22e">nth</span> paddr       vaddr      bind   type size lib             name
<span style="color:#960050;background-color:#1e0010">----------------------------------------------------------------</span>
<span style="color:#960050;background-color:#1e0010">0</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x000a5e70</span> <span style="color:#ae81ff">0x200a5e70</span> GLOBAL FUNC <span style="color:#ae81ff">0</span>    jampgamex86.dll dllEntry
<span style="color:#960050;background-color:#1e0010">1</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00092a10</span> <span style="color:#ae81ff">0x20092a10</span> GLOBAL FUNC <span style="color:#ae81ff">0</span>    jampgamex86.dll vmMain
</code></pre></div><p>So lets see the disassembly of the vmMain function:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-nasm" data-lang="nasm"><span style="color:#960050;background-color:#1e0010">[0</span><span style="color:#a6e22e">x200ddd31</span>]<span style="color:#f92672">&gt;</span> pdf <span style="color:#960050;background-color:#1e0010">@</span> <span style="color:#ae81ff">0x20092a10</span>
<span style="color:#960050;background-color:#1e0010">/</span> <span style="color:#960050;background-color:#1e0010">1489:</span> <span style="color:#a6e22e">sym.jampgamex86.dll_vmMain</span> (int32_t arg_4h, int32_t arg_8h, int32_t arg_ch, int32_t arg_10h, int32_t arg_14h, int32_t arg_18h, int32_t arg_1ch, int32_t arg_20h, int32_t arg_24h, int32_t arg_28h)<span style="color:#75715e">;</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#75715e">; var int32_t var_3dch @ esp+0x14</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#75715e">; var int32_t var_3d4h @ esp+0x1c</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#75715e">; var int32_t var_3d0h @ esp+0x20</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#75715e">; var int32_t var_3cch @ esp+0x24</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#75715e">; var int32_t var_3a0h @ esp+0x50</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#75715e">; var int32_t var_394h @ esp+0x5c</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#75715e">; var int32_t var_390h @ esp+0x60</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#75715e">; var int32_t var_38ch @ esp+0x64</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#75715e">; var int32_t var_388h @ esp+0x68</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#75715e">; var int32_t var_384h @ esp+0x6c</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#75715e">; var int32_t var_380h @ esp+0x70</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#75715e">; var int32_t var_37ch @ esp+0x74</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#75715e">; var int32_t var_378h @ esp+0x78</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#75715e">; var int32_t var_370h @ esp+0x80</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#75715e">; var int32_t var_36ch @ esp+0x84</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#75715e">; arg int32_t arg_4h @ esp+0x3f4</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#75715e">; arg int32_t arg_8h @ esp+0x3f8</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#75715e">; arg int32_t arg_ch @ esp+0x3fc</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#75715e">; arg int32_t arg_10h @ esp+0x400</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#75715e">; arg int32_t arg_14h @ esp+0x404</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#75715e">; arg int32_t arg_18h @ esp+0x408</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#75715e">; arg int32_t arg_1ch @ esp+0x40c</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#75715e">; arg int32_t arg_20h @ esp+0x410</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#75715e">; arg int32_t arg_24h @ esp+0x414</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#75715e">; arg int32_t arg_28h @ esp+0x418</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20092a10</span>      <span style="color:#ae81ff">8</span>b442404       eax <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#66d9ef">dword</span> [arg_4h]
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20092a14</span>      <span style="color:#ae81ff">83</span>f827         var <span style="color:#960050;background-color:#1e0010">=</span> eax <span style="color:#f92672">-</span> <span style="color:#ae81ff">0x27</span>            <span style="color:#75715e">; 39</span>
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">,=&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20092a17</span>      <span style="color:#ae81ff">0</span>f8713040000   if (((unsigned) var) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) goto case.default.0x20092a1d
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#75715e">;-- switch</span>
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20092a1d</span>      ff2485342e09.  goto <span style="color:#66d9ef">dword</span> [eax<span style="color:#f92672">*</span><span style="color:#ae81ff">4</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x20092e34</span>] <span style="color:#75715e">; switch table (40 cases) at 0x20092e34</span>
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#75715e">; CODE XREF from sym.jampgamex86.dll_vmMain @ 0x20092a1d</span>
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#75715e">;-- case 0:                                                ; from 0x20092a1d</span>
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20092a24</span>      <span style="color:#ae81ff">8</span>b442410       eax <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#66d9ef">dword</span> [arg_10h]
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20092a28</span>      <span style="color:#ae81ff">8</span>b4c240c       ecx <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#66d9ef">dword</span> [arg_ch]
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20092a2c</span>      <span style="color:#ae81ff">8</span>b542408       edx <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#66d9ef">dword</span> [arg_8h]
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20092a30</span>      <span style="color:#ae81ff">50</span>             push eax                    <span style="color:#75715e">; int32_t arg_ch</span>
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20092a31</span>      <span style="color:#ae81ff">51</span>             push ecx                    <span style="color:#75715e">; int32_t arg_8h</span>
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20092a32</span>      <span style="color:#ae81ff">52</span>             push edx                    <span style="color:#75715e">; int32_t arg_4h</span>
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20092a33</span>      e8d8d8ffff     fcn.20090310 ()
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20092a38</span>      <span style="color:#ae81ff">83</span>c40c         esp <span style="color:#f92672">+</span><span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#ae81ff">0xc</span>
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20092a3b</span>      <span style="color:#ae81ff">33</span>c0           eax <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#ae81ff">0</span>
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20092a3d</span>      c3             return
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#75715e">; CODE XREF from sym.jampgamex86.dll_vmMain @ 0x20092a1d</span>
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#75715e">;-- case 1:                                                ; from 0x20092a1d</span>
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20092a3e</span>      <span style="color:#ae81ff">8</span>b442408       eax <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#66d9ef">dword</span> [arg_ch]
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20092a42</span>      <span style="color:#ae81ff">50</span>             push eax                    <span style="color:#75715e">; int32_t arg_4h</span>
</code></pre></div><p>We can see it is a huge jump table (Switch) with lots of cases, one for each member of the aforementioned struct. Our interesting use case scenario is the third switch which matches <code>GAME_CLIENT_CONNECT</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-nasm" data-lang="nasm"><span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#75715e">; CODE XREF from sym.jampgamex86.dll_vmMain @ 0x20092a1d</span>
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#75715e">;-- case 2:                                                ; from 0x20092a1d</span>
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20092a4e</span>      <span style="color:#ae81ff">8</span>b4c2410       ecx <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#66d9ef">dword</span> [arg_18h]
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20092a52</span>      <span style="color:#ae81ff">8</span>b54240c       edx <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#66d9ef">dword</span> [arg_14h]
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20092a56</span>      <span style="color:#ae81ff">8</span>b442408       eax <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#66d9ef">dword</span> [arg_10h]
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20092a5a</span>      <span style="color:#ae81ff">51</span>             push ecx                    <span style="color:#75715e">; int32_t arg_ch</span>
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20092a5b</span>      <span style="color:#ae81ff">52</span>             push edx                    <span style="color:#75715e">; int32_t arg_8h</span>
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20092a5c</span>      <span style="color:#ae81ff">50</span>             push eax                    <span style="color:#75715e">; int32_t arg_4h</span>
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20092a5d</span>      e87e61feff     fcn.20078be0 ()
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20092a62</span>      <span style="color:#ae81ff">83</span>c40c         esp <span style="color:#f92672">+</span><span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#ae81ff">0xc</span>
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20092a65</span>      c3             return
</code></pre></div><p>This code will then call <code>fcn.20078be0</code> that in this case is the client validation function. This includes a valid ping, a valid user infostring, a valid password (if server is password protected) and whether the user is banned or not:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-nasm" data-lang="nasm"><span style="color:#960050;background-color:#1e0010">[0</span><span style="color:#a6e22e">x200ddd31</span>]<span style="color:#f92672">&gt;</span> s fcn.20078be0
<span style="color:#960050;background-color:#1e0010">[0</span><span style="color:#a6e22e">x20078be0</span>]<span style="color:#f92672">&gt;</span> pdf
            <span style="color:#75715e">; CALL XREF from fcn.20075770 @ 0x20075b9e</span>
            <span style="color:#75715e">; CALL XREF from sym.jampgamex86.dll_vmMain @ 0x20092a5d</span>
<span style="color:#960050;background-color:#1e0010">/</span> <span style="color:#960050;background-color:#1e0010">720:</span> <span style="color:#a6e22e">fcn.20078be0</span> (int32_t arg_4h, int32_t arg_8h, int32_t arg_ch)<span style="color:#75715e">;</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#75715e">; var int32_t var_400h @ esp+0x2c</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#75715e">; arg int32_t arg_4h @ esp+0x430</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#75715e">; arg int32_t arg_8h @ esp+0x434</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#75715e">; arg int32_t arg_ch @ esp+0x438</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078be0</span>      <span style="color:#ae81ff">81</span>ec00040000   esp <span style="color:#f92672">-</span><span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#ae81ff">0x400</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078be6</span>      <span style="color:#ae81ff">55</span>             push ebp
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078be7</span>      <span style="color:#ae81ff">57</span>             push edi
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078be8</span>      <span style="color:#ae81ff">8</span>bbc240c0400.  edi <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#66d9ef">dword</span> [arg_4h]
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078bef</span>      <span style="color:#ae81ff">8</span>bef           ebp <span style="color:#960050;background-color:#1e0010">=</span> edi
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078bf1</span>      <span style="color:#ae81ff">69</span>edec050000   ebp <span style="color:#960050;background-color:#1e0010">=</span> ebp <span style="color:#f92672">*</span> <span style="color:#ae81ff">0x5ec</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078bf7</span>      <span style="color:#ae81ff">6800040000</span>     push <span style="color:#ae81ff">0x400</span>                  <span style="color:#75715e">; 1024 ; int32_t arg_ch</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078bfc</span>      <span style="color:#ae81ff">8</span>d44240c       eax <span style="color:#960050;background-color:#1e0010">=</span> [var_400h]
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c00</span>      <span style="color:#ae81ff">50</span>             push eax                    <span style="color:#75715e">; int32_t arg_8h</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c01</span>      <span style="color:#ae81ff">57</span>             push edi                    <span style="color:#75715e">; int32_t arg_4h</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c02</span>      <span style="color:#ae81ff">81</span>c5e00f6320   ebp <span style="color:#f92672">+</span><span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#ae81ff">0x20630fe0</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c08</span>      e8d3d40200     fcn.200a60e0 ()
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c0d</span>      <span style="color:#ae81ff">8</span>d4c2414       ecx <span style="color:#960050;background-color:#1e0010">=</span> [var_400h]
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c11</span>      <span style="color:#ae81ff">6830</span>b10f20     push <span style="color:#ae81ff">0x200fb130</span>             <span style="color:#75715e">; &#34;ip&#34; ; int32_t arg_2004h</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c16</span>      <span style="color:#ae81ff">51</span>             push ecx                    <span style="color:#75715e">; int32_t arg_0h</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c17</span>      e864740400     fcn.200c0080 ()
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c1c</span>      <span style="color:#ae81ff">50</span>             push eax                    <span style="color:#75715e">; int32_t arg_4h</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c1d</span>      e80ecb0200     fcn.200a5730 ()
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c22</span>      <span style="color:#ae81ff">83</span>c418         esp <span style="color:#f92672">+</span><span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#ae81ff">0x18</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c25</span>      <span style="color:#ae81ff">85</span>c0           var <span style="color:#960050;background-color:#1e0010">=</span> eax <span style="color:#f92672">&amp;</span> eax
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">,=&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c27</span>      <span style="color:#ae81ff">740</span>e           if (<span style="color:#960050;background-color:#1e0010">!</span>var) goto <span style="color:#ae81ff">0x20078c37</span>
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c29</span>      <span style="color:#ae81ff">5</span>f             pop edi
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c2a</span>      b8b0b10f20     eax <span style="color:#960050;background-color:#1e0010">=</span> str.Banned.           <span style="color:#75715e">; 0x200fb1b0 ; &#34;Banned.&#34;</span>
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c2f</span>      <span style="color:#ae81ff">5</span>d
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c30</span>      <span style="color:#ae81ff">81</span>c400040000   esp <span style="color:#f92672">+</span><span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#ae81ff">0x400</span>
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c36</span>      c3             return
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#75715e">; CODE XREF from fcn.20078be0 @ 0x20078c27</span>
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">`-&gt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c37</span>      f68538020000.  var <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#66d9ef">byte</span> [ebp <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x238</span>] <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">8</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c3e</span>      <span style="color:#ae81ff">53</span>             push ebx
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c3f</span>      <span style="color:#ae81ff">56</span>             push esi
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">,=&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c40</span>      <span style="color:#ae81ff">0</span>f85c0000000   if (var) goto <span style="color:#ae81ff">0x20078d06</span>
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c46</span>      <span style="color:#ae81ff">8</span>b84241c0400.  eax <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#66d9ef">dword</span> [arg_ch]
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c4d</span>      <span style="color:#ae81ff">85</span>c0           var <span style="color:#960050;background-color:#1e0010">=</span> eax <span style="color:#f92672">&amp;</span> eax
<span style="color:#960050;background-color:#1e0010">|</span>      <span style="color:#960050;background-color:#1e0010">,==&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c4f</span>      <span style="color:#ae81ff">0</span>f85b1000000   if (var) goto <span style="color:#ae81ff">0x20078d06</span>
<span style="color:#960050;background-color:#1e0010">|</span>      <span style="color:#960050;background-color:#1e0010">||</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c55</span>      a1ac257b20     eax <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#66d9ef">dword</span> [<span style="color:#ae81ff">0x207b25ac</span>]    <span style="color:#75715e">; [0x207b25ac:4]=0</span>
<span style="color:#960050;background-color:#1e0010">|</span>      <span style="color:#960050;background-color:#1e0010">||</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c5a</span>      <span style="color:#ae81ff">85</span>c0           var <span style="color:#960050;background-color:#1e0010">=</span> eax <span style="color:#f92672">&amp;</span> eax
<span style="color:#960050;background-color:#1e0010">|</span>     <span style="color:#960050;background-color:#1e0010">,===&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c5c</span>      <span style="color:#ae81ff">0</span>f84a4000000   if (<span style="color:#960050;background-color:#1e0010">!</span>var) goto <span style="color:#ae81ff">0x20078d06</span>
<span style="color:#960050;background-color:#1e0010">|</span>     <span style="color:#960050;background-color:#1e0010">|||</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c62</span>      <span style="color:#ae81ff">8</span>d542410       edx <span style="color:#960050;background-color:#1e0010">=</span> [var_400h]
<span style="color:#960050;background-color:#1e0010">|</span>     <span style="color:#960050;background-color:#1e0010">|||</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c66</span>      <span style="color:#ae81ff">68</span>a4b10f20     push str.password           <span style="color:#75715e">; 0x200fb1a4 ; &#34;password&#34; ; int32_t arg_2004h</span>
<span style="color:#960050;background-color:#1e0010">|</span>     <span style="color:#960050;background-color:#1e0010">|||</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c6b</span>      <span style="color:#ae81ff">52</span>             push edx                    <span style="color:#75715e">; int32_t arg_0h</span>
<span style="color:#960050;background-color:#1e0010">|</span>     <span style="color:#960050;background-color:#1e0010">|||</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c6c</span>      e80f740400     fcn.200c0080 ()
<span style="color:#960050;background-color:#1e0010">|</span>     <span style="color:#960050;background-color:#1e0010">|||</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c71</span>      <span style="color:#ae81ff">8</span>bf0           esi <span style="color:#960050;background-color:#1e0010">=</span> eax
<span style="color:#960050;background-color:#1e0010">|</span>     <span style="color:#960050;background-color:#1e0010">|||</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c73</span>      a070026320     al <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#66d9ef">byte</span> [<span style="color:#ae81ff">0x20630270</span>]      <span style="color:#75715e">; [0x20630270:1]=0</span>
<span style="color:#960050;background-color:#1e0010">|</span>     <span style="color:#960050;background-color:#1e0010">|||</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c78</span>      <span style="color:#ae81ff">83</span>c408         esp <span style="color:#f92672">+</span><span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#ae81ff">8</span>
<span style="color:#960050;background-color:#1e0010">|</span>     <span style="color:#960050;background-color:#1e0010">|||</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c7b</span>      <span style="color:#ae81ff">84</span>c0           var <span style="color:#960050;background-color:#1e0010">=</span> al <span style="color:#f92672">&amp;</span> al
<span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">,====&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c7d</span>      <span style="color:#ae81ff">0</span>f8483000000   if (<span style="color:#960050;background-color:#1e0010">!</span>var) goto <span style="color:#ae81ff">0x20078d06</span>
<span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">||||</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c83</span>      <span style="color:#ae81ff">68</span>c09d0e20     push <span style="color:#ae81ff">0x200e9dc0</span>             <span style="color:#75715e">; &#34;none&#34; ; int32_t arg_8h</span>
<span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">||||</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x20078c88</span>      <span style="color:#ae81ff">6870026320</span>     push <span style="color:#ae81ff">0x20630270</span>             <span style="color:#75715e">; int32_t arg_4h</span>
</code></pre></div><p>In this case what we are able to inspect, is the three arguments sent to vmMain: clientId, firstTime and isBot.</p>
<ul>
<li>
<p>clientId: Client ID to be assigned.</p>
</li>
<li>
<p>firstTime: Already in server or connected from change map.</p>
</li>
<li>
<p>isBot: Client is player or bot.</p>
</li>
</ul>
<p>So let&rsquo;s write our instrumentation script. To test it, we will be using a server with 5 bots so our client ID is not 0:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bat" data-lang="bat">status
map: mp/ffa1
num score ping name            lastmsg address               qport rate
--- ----- ---- --------------- ------- --------------------- ----- -----
  0     0    0 Jedi Trainer         50                   bot     0 16384
  1     0    0 Mercenary            50                   bot     0 16384
  2     0    0 Desann               50                   bot     0 16384
  3     0    0 Reborn               50                   bot     0 16384
  4     0    0 Imperial Sabote      50                   bot     0 16384
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typescript" data-lang="typescript"><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">log</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;./logger&#34;</span>;

<span style="color:#75715e">// gameExport_t struct members.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">GAME_INIT</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">GAME_SHUTDOWN</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">GAME_CLIENT_CONNECT</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>;
<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">GAME_CLIENT_BEGIN</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>;
<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">GAME_CLIENT_USERINFO_CHANGED</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>;

<span style="color:#75715e">// dllEntry and vmMain pointers.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">dllEntry</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Module</span>.<span style="color:#a6e22e">getExportByName</span>(<span style="color:#e6db74">&#34;jampgamex86.dll&#34;</span>, <span style="color:#e6db74">&#34;dllEntry&#34;</span>);
<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">vmMainPtr</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Module</span>.<span style="color:#a6e22e">getExportByName</span>(<span style="color:#e6db74">&#34;jampgamex86.dll&#34;</span>, <span style="color:#e6db74">&#34;vmMain&#34;</span>);

<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;dllEntry: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">dllEntry</span>);
<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;vmMainPtr: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">vmMainPtr</span>);

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">vmMain</span> {
  <span style="color:#a6e22e">onEnter</span> (<span style="color:#a6e22e">args</span>:<span style="color:#66d9ef">NativePointer</span>[]) {
    <span style="color:#75715e">// First argument a.k.a args[0] is the one interacting with
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// our switch case. Therefore, we will use it ourselves to find the player
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// connect call.
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">switch</span> (<span style="color:#a6e22e">args</span>[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">toInt32</span>()) {
      <span style="color:#66d9ef">case</span> <span style="color:#a6e22e">GAME_INIT</span>:
        <span style="color:#66d9ef">log</span>(<span style="color:#e6db74">&#39;[+] Game init.&#39;</span>);
        <span style="color:#66d9ef">break</span>;
      <span style="color:#66d9ef">case</span> <span style="color:#a6e22e">GAME_SHUTDOWN</span>:
        <span style="color:#66d9ef">log</span>(<span style="color:#e6db74">&#39;[*] Game shutdown.&#39;</span>);
        <span style="color:#66d9ef">break</span>;
      <span style="color:#66d9ef">case</span> <span style="color:#a6e22e">GAME_CLIENT_CONNECT</span>:
        <span style="color:#66d9ef">log</span>(<span style="color:#e6db74">&#39;[+] Client connected.&#39;</span>)
        <span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;\tclientId: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">args</span>[<span style="color:#ae81ff">1</span>].<span style="color:#a6e22e">toInt32</span>());
        <span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;\tfirstTime: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">args</span>[<span style="color:#ae81ff">2</span>].<span style="color:#a6e22e">toInt32</span>());
        <span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;\tisBot: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">args</span>[<span style="color:#ae81ff">3</span>].<span style="color:#a6e22e">toInt32</span>());
        <span style="color:#66d9ef">break</span>;
      <span style="color:#66d9ef">case</span> <span style="color:#a6e22e">GAME_CLIENT_BEGIN</span>:
        <span style="color:#66d9ef">log</span>(<span style="color:#e6db74">&#39;[^] Client begin.&#39;</span>);
        <span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;\tclientId: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">args</span>[<span style="color:#ae81ff">1</span>].<span style="color:#a6e22e">toInt32</span>());
        <span style="color:#66d9ef">break</span>;
      <span style="color:#66d9ef">case</span> <span style="color:#a6e22e">GAME_CLIENT_USERINFO_CHANGED</span>:
        <span style="color:#66d9ef">log</span>(<span style="color:#e6db74">&#39;[~] Userinfo changed.&#39;</span>);
        <span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;\tclientId: &#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">args</span>[<span style="color:#ae81ff">1</span>].<span style="color:#a6e22e">toInt32</span>());
        <span style="color:#66d9ef">break</span>
    }
  }
}

<span style="color:#a6e22e">Interceptor</span>.<span style="color:#a6e22e">attach</span>(<span style="color:#a6e22e">vmMainPtr</span>, <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">vmMain</span>);
</code></pre></div><p>So in this case, we are getting the pointer to vmMain from <code>jampgamex86.dll</code> that the engine has loaded and intercept it to filter out connected clients.</p>
<p>And our script output with two new clients is:</p>
<p><a href="https://asciinema.org/a/vhrRAE6RVBgEGvGScNkaz1qJC"><img src="https://asciinema.org/a/vhrRAE6RVBgEGvGScNkaz1qJC.svg" alt="asciicast"></a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">     ____
    / _  |   Frida 12.10.4 - A world-class dynamic instrumentation toolkit
   | (_| |
    &gt; _  |   Commands<span style="color:#960050;background-color:#1e0010">:</span>
   /_/ |_|       help      -&gt; Displays the help system
   . . . .       object?   -&gt; Display information about <span style="color:#e6db74">&#39;object&#39;</span>
   . . . .       exit/quit -&gt; Exit
   . . . .
   . . . .   More info at https<span style="color:#960050;background-color:#1e0010">:</span>//www.frida.re/docs/home/
Attaching...
dllEntry<span style="color:#960050;background-color:#1e0010">:</span> 0x200a5e70
vmMainPtr<span style="color:#960050;background-color:#1e0010">:</span> 0x20092a10
[Remote::jampded.exe]-&gt; 0x2
[+] Client connected.
	clientId<span style="color:#960050;background-color:#1e0010">:</span> 5
	firstTime<span style="color:#960050;background-color:#1e0010">:</span> 1
	isBot<span style="color:#960050;background-color:#1e0010">:</span> 0
[~] Userinfo changed.
	clientId<span style="color:#960050;background-color:#1e0010">:</span> 5
[^] Client <span style="color:#66d9ef">begin</span>.
	clientId<span style="color:#960050;background-color:#1e0010">:</span> 5

[+] Client connected.
	clientId<span style="color:#960050;background-color:#1e0010">:</span> 0
	firstTime<span style="color:#960050;background-color:#1e0010">:</span> 1
	isBot<span style="color:#960050;background-color:#1e0010">:</span> 0
[~] Userinfo changed.
	clientId<span style="color:#960050;background-color:#1e0010">:</span> 0
[^] Client <span style="color:#66d9ef">begin</span>.
	clientId<span style="color:#960050;background-color:#1e0010">:</span> 0
[*] Game shutdown.
[Remote::jampded.exe]-&gt;
</code></pre></div><p>Isn&rsquo;t it weird that we were told that the second clientId is 0? But let&rsquo;s check the server status   client list :)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bat" data-lang="bat">map: mp/ffa1
num score ping name            lastmsg address               qport rate
--- ----- ---- --------------- ------- --------------------- ----- -----
  0     0    0 Padawan               0    192.168.56.1:29072 60970 25000
  2     1    0 Desann               50                   bot     0 16384
  3     1    0 Reborn               50                   bot     0 16384
  4     0    0 Imperial Sabote      50                   bot     0 16384
  5     0    1 [DARK]S       0    192.168.56.1:29071 12395 25000
</code></pre></div><p>I will expand this blogpost further with the aim of proxying engine calls. :)</p>
<p>Have a good day!</p>

    <h4><a href="https://azurda.github.io">Back to Home</a></h4>
</div>


        </div><footer class="container">
    <hr class="soften">
    <p>
&copy; 
<a href="https://azurda.github.io" target="_blank">
    Azurda
</a>
<span id="thisyear">2021</span>

    | Azurda&rsquo;s blog.


</p>
    <p class="text-center">
        
        <a href="https://twitter.com/entdark_">Twitter</a> 
        
        <a href="https://github.com/azurda">GitHub</a> 
        
    </p>
</footer>

</body><link rel="stylesheet" href="/css/bootstrap.css">
<link rel="stylesheet" href="/css/bootstrap-responsive.css">
<link rel="stylesheet" href="/css/style.css">

<script src="/js/jquery.js"></script>
<script src="/js/bootstrap-386.js"></script>
<script src="/js/bootstrap-transition.js"></script>
<script src="/js/bootstrap-alert.js"></script>
<script src="/js/bootstrap-modal.js"></script>
<script src="/js/bootstrap-dropdown.js"></script>
<script src="/js/bootstrap-scrollspy.js"></script>
<script src="/js/bootstrap-tab.js"></script>
<script src="/js/bootstrap-tooltip.js"></script>
<script src="/js/bootstrap-popover.js"></script>
<script src="/js/bootstrap-button.js"></script>
<script src="/js/bootstrap-collapse.js"></script>
<script src="/js/bootstrap-carousel.js"></script>
<script src="/js/bootstrap-typeahead.js"></script>
<script src="/js/bootstrap-affix.js"></script>
<script>
    _386 = { 
        fastLoad: true ,
        onePass: false , 
        speedFactor: 1 
    };

    
    function ThisYear() {
        document.getElementById('thisyear').innerHTML = new Date().getFullYear();
    };
</script></html>
